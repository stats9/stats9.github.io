<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title></title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Anova-SS.html" rel="next">
<link href="./BlueSky.html" rel="prev">
<link href="././images/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="">
<meta property="og:description" content="">
<meta property="og:image" content="https://stats9.github.io/images/pval.jpg">
<meta property="og:locale" content="es_ES">
<meta property="og:site-name" content="stats9">
<meta name="twitter:title" content="">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://stats9.github.io/images/logo_image.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="././images/logo_image.jpg" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./about.html" rel="" target="" aria-current="page">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./BlueSky.html" rel="" target="">
 <span class="menu-text">BlueSky</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Pvalue.html" rel="" target="">
 <span class="menu-text">P<sub>value</sub></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Anova-SS.html" rel="" target="">
 <span class="menu-text">Anova-SS</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://github.com/stats9" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/habib-ezzat-abadi-pour-23300abb/" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
    <a href="mailto:habibezati88@gmail.com" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope-at"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Pvalue.html">P<sub>value</sub></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-envelope-at"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="mailto:habibezati88@gmail.com">
            report a problem
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="mailto:habibezati88@gmail.com">
            Suggestion
            </a>
          </li>
      </ul>
    </div>
</div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BlueSky.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BlueSky</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pvalue.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">P<sub>value</sub></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Anova-SS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anova-SS</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#calculating-pvalue-for-multiple-comparisons-in-one-way-anova" id="toc-calculating-pvalue-for-multiple-comparisons-in-one-way-anova" class="nav-link active" data-scroll-target="#calculating-pvalue-for-multiple-comparisons-in-one-way-anova">Calculating p<sub>value</sub> for multiple comparisons in one-way ANOVA</a></li>
  <li><a href="#what-is-pvalue" id="toc-what-is-pvalue" class="nav-link" data-scroll-target="#what-is-pvalue">What is p<sub>value</sub></a></li>
  <li><a href="#pvalue-problems" id="toc-pvalue-problems" class="nav-link" data-scroll-target="#pvalue-problems">p<sub>value</sub> Problems</a></li>
  <li><a href="#the-problem-of-multiple-comparisons" id="toc-the-problem-of-multiple-comparisons" class="nav-link" data-scroll-target="#the-problem-of-multiple-comparisons">The problem of multiple comparisons</a></li>
  <li><a href="#bonferronis-method-for-correcting-type-1-error-in-multiple-tests" id="toc-bonferronis-method-for-correcting-type-1-error-in-multiple-tests" class="nav-link" data-scroll-target="#bonferronis-method-for-correcting-type-1-error-in-multiple-tests">Bonferroni’s method for correcting type 1 error in multiple tests</a></li>
  <li><a href="#holms-method-for-correcting-type-1-error-in-multiple-tests" id="toc-holms-method-for-correcting-type-1-error-in-multiple-tests" class="nav-link" data-scroll-target="#holms-method-for-correcting-type-1-error-in-multiple-tests">Holm’s method for correcting type 1 error in multiple tests</a></li>
  <li><a href="#hochbergs-method-for-correcting-type-1-error-in-multiple-tests" id="toc-hochbergs-method-for-correcting-type-1-error-in-multiple-tests" class="nav-link" data-scroll-target="#hochbergs-method-for-correcting-type-1-error-in-multiple-tests">Hochberg’s method for correcting type 1 error in multiple tests</a></li>
  <li><a href="#hommels-method-for-correcting-type-1-error-in-multiple-tests" id="toc-hommels-method-for-correcting-type-1-error-in-multiple-tests" class="nav-link" data-scroll-target="#hommels-method-for-correcting-type-1-error-in-multiple-tests">Hommel’s method for correcting type 1 error in multiple tests</a></li>
  <li><a href="#benjamini-hochberg-method-bh-for-correcting-type-1-error-in-multiple-tests" id="toc-benjamini-hochberg-method-bh-for-correcting-type-1-error-in-multiple-tests" class="nav-link" data-scroll-target="#benjamini-hochberg-method-bh-for-correcting-type-1-error-in-multiple-tests">Benjamini-Hochberg Method (BH) for correcting type 1 error in multiple tests</a></li>
  <li><a href="#benjumaini-and-yekutieli-method-by-for-correcting-type-1-error-in-multiple-tests" id="toc-benjumaini-and-yekutieli-method-by-for-correcting-type-1-error-in-multiple-tests" class="nav-link" data-scroll-target="#benjumaini-and-yekutieli-method-by-for-correcting-type-1-error-in-multiple-tests">Benjumaini and Yekutieli Method (BY) for correcting type 1 error in multiple tests</a></li>
  <li><a href="#false-discovery-rate-fdr-method-for-correcting-type-1-error-in-multiple-tests" id="toc-false-discovery-rate-fdr-method-for-correcting-type-1-error-in-multiple-tests" class="nav-link" data-scroll-target="#false-discovery-rate-fdr-method-for-correcting-type-1-error-in-multiple-tests">False Discovery Rate (FDR) Method for correcting type 1 error in multiple tests</a></li>
  <li><a href="#posthoc-tests-with-adjusted-pvalue" id="toc-posthoc-tests-with-adjusted-pvalue" class="nav-link" data-scroll-target="#posthoc-tests-with-adjusted-pvalue">PostHoc Tests With Adjusted P<sub>value</sub></a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<p><img src="./images/pval.jpg" align="center" alt="my pix" width="800" height="400"> <br><br></p>
<section id="calculating-pvalue-for-multiple-comparisons-in-one-way-anova" class="level2">
<h2 class="anchored" data-anchor-id="calculating-pvalue-for-multiple-comparisons-in-one-way-anova">Calculating p<sub>value</sub> for multiple comparisons in one-way ANOVA</h2>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

<h4 style="color: blue;" class="anchored">
محاسبه <bdi>p<sub>value</sub></bdi>&nbsp; برای مقایسه‌های چند گانه در آنالیز واریانس یک‌طرفه
</h4>
<br><br> 

داده‌های موجود و البته مخصوصا داده‌های زیستی امروزه در مقیاس وسیعی تولید می شود. این امر جدا از آن‌که منجر به ذخیره انبوهی از داده‌های خام شده هست، بلکه باعث شکل‌گیری آزمون‌های فرض مختلفی نیز بوده هست. برای آزمایش این فرضیه‌ها، روش‌هایی از آمار استنباطی بر‌روی مجموعه‌ داده‌ها اِعمال می‌شود که منجر به بینش‌های زیستی بیشتر(برای داده‌های زیستی) و اصولا بینش عمیق‌تر در مورد داده‌ها می‌شود. اساسا، آزمون فرض یک روش آماری هست که احتمال موافق بودن داده‌ها را که بر‌اساس یک نمونه‌گیری تصادفی جمع‌آوری شده‌اند، با فرض صفر (یا مخالف فرض صفر) محاسبه می‌کند و نتایج این محاسبات در یک عدد خاص با نماد <bdi>p<sub>value</sub></bdi>&nbsp; خلاصه می‌شود. من پیرو قولی که در زمان ضبط ویدئوهای مربوط به <bdi>BlueSky</bdi>&nbsp; داده‌ام می‌خواهم درباره‌ تصحیح مقادیر <bdi>p<sub>value</sub></bdi>&nbsp; یک گزارش نسبتا مفصل ارائه بدم، ولی قبل از آن‌که در مورد تصحیح <bdi>p<sub>value</sub></bdi>&nbsp;  برای مقایسه‌های چند‌گانه صحبت کنم، در مورد خود آن توضیح کوتاهی ارائه خواهم داد. 


</div>
</section>
<section id="what-is-pvalue" class="level2">
<h2 class="anchored" data-anchor-id="what-is-pvalue">What is p<sub>value</sub></h2>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

<h4 style="color:blue;" class="anchored"> 
<bdi> p<sub>value</sub></bdi>&nbsp;  چیست؟
</h4>

هنگامی که می‌خواهید به صورت آماری استنباط کنید که آیا نتیجه آزمون آماری قابل‌توجه (معنادار) هست یا خیر، با توجه به فرض صفر <bdi>(H<sub>0</sub>)</bdi>&nbsp;، احتمال شکل‌گیری نتیجه مشاهده شده را با وضعیتی که در آن همه چیز کاملا تصادفی باشد البته با پذیرش درستی فرض صفر، مقایسه می‌کنیم. یک مقدار یا برشی که به عنوان مرز تصمیم گیری که البته هم بر‌اساس روابط تکنیکی ریاضی و هم تاریخی بر‌روی آن یک اجماع نسبی وجود دارد (البته با توجه به زمینه و بستر مطالعه) که با عنوان خطای نوع اول یا <bdi>α</bdi>&nbsp; که معمولا  برابر با مقادیر<bdi>0.1, 0.05, 0.01, 0.001</bdi>&nbsp;  می‌باشد، در نظر گرفته می‌شود. با توجه به نقطه برش یا خط مرزی درنظر گرفته شده، برای مثال اگر فرض صفر برابری میانگین‌های چند‌ گروه باشید، یعنی؛
</div>
<p><span class="math display">\[
\begin{cases}H_0:&amp; \mu_1 = \mu_2 = \cdots = \mu_k\\
H_1: &amp; \exists ~~ i, j ~~s.t~~ \mu_i \ne \mu_j, ~~ i, j = 1, 2, ..., k, \quad i \ne j\end{cases}
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
اگر مقدار <bdi>p<sub>value</sub></bdi>&nbsp; به‌دست آمده کمتر از نقطه برش انتخاب شده یا همان <bdi>α</bdi>&nbsp; باشد فرض صفر رد می‌شود و در غیر این صورت فرض صفر تأیید می‌شود. البته باید ذکر شود که در آزمون‌های آماری صرف بیان کردن مقدار <bdi>p<sub>value</sub></bdi>&nbsp; کفایت نمی‌کند. و باید علاوه بر این مقدار کمیت‌هایی مانند فواصل اطمینان، توان آزمون و یا اندازه اثر و ... می‌تواند در کنار مقدار <bdi>p<sub>value</sub></bdi>&nbsp; گزارش شود.
<br>

</div>
</section>
<section id="pvalue-problems" class="level2">
<h2 class="anchored" data-anchor-id="pvalue-problems">p<sub>value</sub> Problems</h2>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

<h4 style="color: blue;" class="anchored">
مشکلات <bdi>p<sub>value</sub></bdi>&nbsp; 
</h4>

حقیقت این هست که بحث جدل زیادی پیرامون موقعیت و اهمیت <bdi>p<sub>value</sub></bdi>&nbsp; در محافل علمی وجود دارد. و این موضوع با ظهور کلان‌داده‌ها که عمدتا حول سوء تفاهم و همچنین استفاده نادرست از <bdi>p<sub>value</sub></bdi>&nbsp; می‌شود افزونی یافته هست. اولین ایرادی که وارد می‌کنند این هست که نقاط برش انتخاب شده یعنی <bdi> α = 0.1, 0.05, 0.001, ...</bdi>&nbsp; کاملا دلخواه هستند و صرفا بر‌اساس یک قرار‌داد شکل گرفته‌اند. و این واقعیت مولد آن هست که این مقدار لزوما برای هر زمینه‌ مطالعاتی مناسب نیست و به عنوان مثال برای بعضی از کارآزمایی‌های بالینی حتی مقدار <bdi>α = 0.001</bdi>&nbsp; پیشنهاد می‌شود. علاوه بر‌این، دو تَوَرّش (سوگیری) رایج که به یک‌پارچگی یافته‌های تحقیق اثر می‌گذارد، یکی گزارش‌های انتخابی یا با عنوان انگلیسی <bdi>Selective Reporting</bdi>&nbsp; و دیگری با اصطلاح <bdi>P-Hacking</bdi>&nbsp; شناخته می‌شود، می‌باشد. به‌طور خلاصه گزارش‌ دهی انتخابی به گرایش به سمت گزارش کردن صرفا مقادیر معنادار یعنی زمانی که <bdi>p<sub>value</sub></bdi>&nbsp; از مقدار نقطه برش کمتر هست توجه دارد، که در یک بررسی مشخص شد این اریبی به سمت نتایج معنادار گزارش شده می‌باشد. که در متا‌آنالیز با عنوان اریبی انتشار از آن یاد می‌شود. در مقابل، اصطلاح <bdi>P-Hacking</bdi>&nbsp;  اشاره به نمونه‌‌گیری‌های غیر تصادفی و یا دستکاری عمدی داده‌ها دارد. 
<br>
</div>
</section>
<section id="the-problem-of-multiple-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="the-problem-of-multiple-comparisons">The problem of multiple comparisons</h2>
<div dir="rtl" ,="" style="font-size: 18px; font-family: Yas;">

<h4 style="color:blue;" class="anchored">
مسئله مقایسه‌های چند‌گانه
</h4>

با فرض این‌که تمام ایرادات مطرح شده برطرف شده یا نادیده گرفته شوند، آخرین و اما مهم‌ترین مسئله‌ای که در کمی سازی مقدار <bdi>p<sub>value</sub></bdi>&nbsp; باقی می‌ماند، زمانی هست که یک آزمون چند‌گانه روی می‌دهد، اما آزمون چند‌گانه چه مفهومی می‌تواند داشته باشد؟ وضعیتی را تصور کنید که می‌خواهیم تأثیر چند نوع کود را بر‌روی میزان محصولات با هم مقایسه کنیم، که البته تعداد انواع کود بیشتر از ۲ هست و همچنین با فرض یکسان بودن سایر شرایط، مانند نوع خاک، وسعت زمین، نوع آبیاری و …<br>
و بخواهیم این مقایسه‌ها را به صورت دو‌به‌دو انجام دهیم، یعنی ابتدا کود نوع ۱ را با نوع ۲ و سپس با نوع ۳والی آخر  یعنی به شکل زیر‌
</div>
<p><span class="math display">\[
\begin{aligned}
&amp; \text{Test}_1: ~ \begin{cases}H_0: &amp; \mu_A = \mu_B\\ H_1: &amp; \mu_A\ne \mu_B \end{cases}\\
&amp; \text{Test}_2: ~ \begin{cases}H_0: &amp; \mu_A = \mu_C\\ H_1: &amp; \mu_A\ne \mu_B \end{cases}\\
&amp; \text{Test}_3: ~ \begin{cases}H_0: &amp; \mu_A = \mu_D\\ H_1: &amp; \mu_A\ne \mu_B \end{cases}\\
&amp; \text{Test}_4: ~ \begin{cases}H_0: &amp; \mu_B = \mu_C\\ H_1: &amp; \mu_A\ne \mu_B \end{cases}\\
&amp; \text{Test}_5: ~ \begin{cases}H_0: &amp; \mu_B = \mu_D\\ H_1: &amp; \mu_A\ne \mu_B \end{cases}\\
&amp; \text{Test}_6: ~ \begin{cases}H_0: &amp; \mu_C = \mu_D\\ H_1: &amp; \mu_A\ne \mu_B \end{cases}\\
\end{aligned}
\]</span> <br></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
واضح هست که حروف <bdi>A, B, C, D</bdi>&nbsp; اشاره به نوع کودها دارد، همان‌طور که می بینیم وقتی انواع کود دارای ۴ سطح هست، ما ۶ مقایسه دو به دو خواهیم داشت که ترکیب ۲ از ۴ هست که جواب همان ۶ هست. <br>
حالا اگر خطای نوع اول یا همان <bdi> α = 0.05</bdi>&nbsp; در نظر بگیریم و برای هر ۶ مقایسه همزمان خطای نوع اول را پنج صدم در نظر بگیریم با وضعیت زیر مواجه خواهیم شد: 
</div>
<p><br></p>
<p><span class="math display">\[
\alpha_{Test_1} = \alpha_{Test_2} = \cdots = \alpha_{Test_6} = 0.05\to
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

خطای نوع اول یعنی امکان مشاهده وضعیتی که فرض <bdi>H<sub>0</sub></bdi>&nbsp; را رد کنیم در صورتی که این فرض درست باشد،‌ پس احتمال این‌که فرض <bdi>H<sub>0</sub></bdi>&nbsp; را رد نکنیم در صورتی که این فرض درست باشد می‌شود <bdi> 1 - α </bdi>&nbsp; ولی این مقادیر برای یک آزمون صدق می‌کند، ولی اگه بخواهیم احتمال این‌ را بسنجیم در صورتی برابری تمام میانگین سطوح‌ها ما فرض <bdi>H<sub>0</sub></bdi>&nbsp; را برای هیچ‌کدام از آزمون‌ها  رد نکنیم باید به این شکل آن را محاسبه کنیم

</div>
<p><span class="math display">\[
\begin{aligned}
&amp; \alpha_{Single} = 0.05 \implies P_{single} = 1 - \alpha_{single} = 1 - 0.05 = 0.95\\
&amp; \implies P_{multiple} = P_{single} ^ 6 = 0.7350919 \implies \\
&amp; \alpha_{multiple} = 1 - P_{multiple} = 0.2649081
\end{aligned}
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

همان‌طور که مشاهده می‌کنیم، خطا نوع اول برای مقایسه‌های همزمان به شدت تورم پیدا کرده هست و اگر تعداد مقایسه‌ها افزایش پیدا کند یعنی اگر ما فرضا ۵۰ تا مقایسه همزمان داشته باشیم و خطای نوع اول را را برای همه ۵۰ تا مقایسه پنج‌صدم در نظر بگیریم، آن‌گاه خطای نوع اول آزمون‌های چند‌گانه با توجه به روابطی که بالا آوردیم می‌شود:‌

</div>
<p><span class="math display">\[
\alpha_{multiple} = 1 - P_{multiple} = 1 - (1 - 0.05)^{50} =  0.923055
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
واضح هست که در صورت افزایش مقایسه‌های چند‌گانه خطای نوع اول چند‌گانه به یک هم خواهد رسید. <br>
سؤالی که این‌جا شکل می‌گیرد این هست که چگونه باید جلوی رشد نرخ خطای نوع اول برای مقایسه‌های چند‌گانه گرفته شود؟
<br> 
اولین جوابی که به این سؤال میشه داد، کاهش خطای نوع اول هست. یا در واقع کاهش <bdi>Threshold</bdi>&nbsp; یا آن آستانه‌ای که در صورتی که <bdi>p<sub>value</sub></bdi>&nbsp; از آن کمتر شود فرض اولیه رد می‌شود. یکی از روش‌هایی که برای پاسخ به این پرسش مد نظر قرار می‌گیرد، روش بونفرونی هست که در ادامه به بعضی از روش‌های نسبتا پر‌استفاده  تصحیح خطای نوع اول و یا مقدار <bdi>p<sub>value</sub></bdi>&nbsp; اشاره خواهد شد. 
<br>

قبل از آن‌که به ادامه بحث بپردازیم، برای این‌که یک تصویر بهتر از توضیحاتی که قرار هست ارائه شود شکل گیرد، من روش‌هایی که می‌خواهم در این صفحه به آن‌ها بپردازم را در پایین فهرست می‌کنم: 
<ul>
<li> <bdi> Bonferroni</bdi></li>
<li><bdi>Holm</bdi></li>
<li><bdi>Hochberg</bdi></li>
<li><bdi>Hommel</bdi></li>
<li><bdi>Benjumaini and Hochberg (BH)</bdi></li>
<li><bdi>Benjumaini and Yekutieli (BY)</bdi></li>
<li><bdi>False discovery rate (fdr)</bdi></li>
</ul>
<br>

</div>
</section>
<section id="bonferronis-method-for-correcting-type-1-error-in-multiple-tests" class="level2">
<h2 class="anchored" data-anchor-id="bonferronis-method-for-correcting-type-1-error-in-multiple-tests">Bonferroni’s method for correcting type 1 error in multiple tests</h2>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

<h4 style="color: blue;" class="anchored">
روش بونفرونی برای تصحیح خطای  نوع اول در آزمون‌های چند‌گانه
</h4>
ما برای توضیح این ۷ نوع روش تصحیح <bdi>p<sub>value</sub></bdi>&nbsp; یا خطای نوع اول، یک بردار از مقادیر <bdi>p<sub>value</sub></bdi>&nbsp; محاسبه شده به روش‌های معمولی را مد نظر قرار می‌دهیم، یعنی فرض می‌کنیم که یک  آزمون چند‌گانه را پیاده‌سازی کرده‌ایم و مقادیر محاسبه شده برای <bdi>p<sub>value</sub></bdi>&nbsp; از قرار زیر بوده هست
</div>
<p><br></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>0.0001 0.001 0.01 0.1 0.08 0.09 0.15 0.21 0.35 0.55 0.3 0.64 0.77 0.9 0.03 0.02 0.09 0.19 0.21 0.41</code></pre>
</div>
</div>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
روش بونفرونی رویکرد خیلی ساده‌ای دارد، این روش به ما می گوید که اگر فرضا تعداد مقایسه‌ها (آزمون‌ها) فرضا <bdi>m</bdi>تا آزمون هست، آن‌گاه بر‌اساس خطای نوع اولی که در شروع تعیین می‌کنید، برای مقایسه‌های چند‌گانه این خطا را بر تعداد آزمون‌ها که در این‌جا فرض کردیم <bdi>m</bdi>تا می‌باشد تقسیم کنید و مقادیر <bdi>p<sub>value</sub></bdi>&nbsp;محاسبه شده را با این خطا مقایسه کنید و آن‌گاه اگر مقدار <bdi>p<sub>value</sub></bdi>&nbsp; کمتر از مقدار خطا نوع اول برآورد شده بود فرض <bdi>H<sub>0</sub></bdi>&nbsp; را رد کنید. یعنی؛
</div>
<p><span class="math display">\[
\begin{aligned}
&amp; \text{Initial} ~\alpha = \alpha_0\implies \\
&amp; \text{if number of test}~ = m \implies \text{final}~ \alpha = \alpha_{multiple} = \frac{\alpha_0}{m}
\end{aligned}
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
حالا اگر بخواهیم برای مثالی که در بالا مقادیر <bdi>p<sub>value</sub></bdi>&nbsp; آن را آورده‌ایم، این روش را پیاده‌سازی کنیم، به جواب زیر خواهیم رسید. 
<br>
البته قبل از آن‌که جواب را ببینیم، ذکر یک نکته در این‌جا می تواند اهمیت داشته باشد، و آن این هست که، در <code>R</code> و در بسته <code>stats</code>&nbsp; که همراه <code>R</code> 
بر‌روی سیستم نصب می‌شود، یعنی جز بسته‌های پیش‌فرض هست، تابع <code><b><span style="font-family: courier new;"> p.adjust </span></b></code>&nbsp; روش‌های گفته شده در بالا را پشتیبانی می‌کند و ما می‌توانیم با دادن بردار مقادیر <bdi>p<sub>value</sub></bdi>&nbsp; به این تابع و تعیین نوع تصحیح خروجی که مقادیر اصلاح شده <bdi>p<sub>value</sub></bdi>&nbsp; می‌باشد را داشته باشیم. ولی از نظر من در کتابخانه <code><b><span style="font-family: courier new;"> statsmodels </span></b></code>&nbsp; در پایتون متد‌هایی هست که خروجی بهتری و همچنین روش‌های به نسبت بیشتری را برای تصحیح خطای نوع اول و یا <bdi>p<sub>value</sub></bdi>&nbsp; پشتیبانی می‌کنند. من خروجی در هر دو نرم‌افزار برای شما در پایین می‌آورم تا بهتر متوجه این مسئله بشوید. 
<br><br>
مثال:
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.multitest <span class="im">as</span> stest </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>pVal <span class="op">=</span> [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">.01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> stest.multipletests(pVal, alpha <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># python Result</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(array([ True,  True, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False]), array([0.002, 0.02 , 0.2  , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   ,
       1.   , 1.   , 1.   , 1.   , 1.   , 0.6  , 0.4  , 1.   , 1.   ,
       1.   , 1.   ]), 0.0025613787765302876, 0.0025)</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R Result</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.001</span>, .<span class="dv">01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>), <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.002 0.020 0.200 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000
[13] 1.000 1.000 0.600 0.400 1.000 1.000 1.000 1.000</code></pre>
</div>
</div>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
همان‌طور که مشاهده می‌کنیم خروجی پایتون دارای جزئیات بیشتری هست، خروجی این‌نرم‌افزار علاوه بر مقادیر اصلاح شده <bdi>p<sub>value</sub></bdi>&nbsp; که اگر بخواهیم به شکل مشخص‌تری نشان دهیم؛‌
<br>
</div>
<div style="color: black; font-size: 16px; font-family: courier new;">
<p><b> <span style="color: red;"> (array([ True, True, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False])</span>, <span style="color: green;">array([0.002, 0.02 , 0.2 , 1. , 1. , 1. , 1. , 1. , 1. , 1. , 1. , 1. , 1. , 1. , 0.6 , 0.4 , 1. , 1. , 1. , 1. ])</span>, <span style="color: darkblue;">0.0025613787765302876, 0.0025) </span></b></p><b>
</b><p><b></b></p>
</div>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

خروجی پایتون یک <a href="https://www.geeksforgeeks.org/python-tuples/">تاپل</a> می ‌باشد که شامل ۴ عضو هست، عضو اول و دوم <bdi>array</bdi>&nbsp; می‌باشند و عضو‌های سوم و چهارم مقادیر عددی، آرایه اول در حقیقت نتایج آزمون‌ها را نشان می‌دهد که مقدار <code>True</code>&nbsp; به معنای رد فرض اولیه هست و مقدار <code>False</code>&nbsp; به معنای پذیرش فرض اولیه یا همان <bdi>H<sub>0</sub></bdi>. که در این‌جا این آرایه با رنگ قرمز مشخص شده هست. آرایه دوم که با رنگ سبز مشخص شده هست اشاره دارد به مقادیر <bdi>p<sub>value</sub></bdi>&nbsp;اصلاح شده توسط روش به‌کار برده شده که در این‌جا بونفرونی می‌باشد. و مقادیر عددی که عضو‌های سوم و چهارم این تاپل می‌باشند و با رنگ آبی پر‌رنگ مشخص شده‌اند، عضو سوم اشاره به خطای نوع اول اصلاح شده با روش <code>Sidak</code>&nbsp; دارد. که برای این‌که بدانیم خطای نوع اول اصلاح شده <code>Sidak</code>&nbsp; چگونه محاسبه می‌شود، با توجه به مثال آورده شده در بالا، به معادله زیر توجه کنید: 


</div>
<p><span class="math display">\[
\begin{aligned}
&amp; \alpha_{Sidak} = 1 - (1 - \alpha_{Intiial})^{\frac{1}{\text{\# number of Tests}}} \implies \\
&amp; \text{In This Example:}\quad  \alpha_{Sidak} = 1 - (1 - 0.05)^{\frac{1}{20}} = 0.0025614
\end{aligned}
\]</span></p>
<p><br></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

که البته در این‌جا کمی این مقدار گرد شده هست. و همچنین 
عضو چهارم همان خطای نوع اول اصلاح شده به روش بونفرونی می‌باشد. 

ولی در خروجی <code>R</code> همان‌طور که ملاحظه می‌کنیم فقط مقادیر اصلاح شده <bdi>p<sub>value</sub></bdi>&nbsp; را ما در خروجی می‌بینیم. باز هم ذکر یک نکته حائز اهمیت هست، چرا وقتی ما در روش بونفرونی حرف از اصلاح خطای نوع اول زده‌ایم در این دو تابع مقادیر اصلاح شده برای <bdi>p<sub>value</sub></bdi>&nbsp; برای ما در خروجی ظاهر شده هست. دلیل این امر این هست که هر دو این توابع  یا متدها، به جای آن‌که در حقیقت مقایسه <bdi>p<sub>value</sub></bdi>&nbsp; را با مقدار تقسیم خطای نوع اول بر تعداد آزمون‌ها مقایسه کنند، به جای آن تعداد آزمون‌ها را در مقدار <bdi>p<sub>value</sub></bdi>&nbsp; ضرب می‌کنند و آن گاه مقدار <bdi>p<sub>value</sub></bdi>&nbsp; به‌دست آمده را با همان خطای نوع اول آغازین آزمون مقایسه می‌کنند. ولی در خروجی نهایی پایتون ما خطای نوع اول اصلاح شده نهایی هم در انتها می‌بینیم ولی در خروجی <code>R</code> این چنین نیست. البته باز هم شاید این ابهام شکل بگیرد که ضرب تعداد آزمون‌ها در بعضی از مقادیر <bdi>p<sub>value</sub></bdi>&nbsp; مقادیر گزارش شده در خروجی‌های بالا نیست، برای این مورد باید ذکر شود که مقدار <bdi>p<sub>value</sub></bdi>&nbsp; یک مقدار احتمال هست پس نمی‌تواند بزرگتر از ۱ گزارش شود و برای وقتی که ضرب تعداد آزمون‌ها در <bdi>p<sub>value</sub></bdi>&nbsp; برآورد شده اولیه بزرگتر از ۱ باشد، آن مقدار همان ۱ گزارش می‌شود. 

</div>
</section>
<section id="holms-method-for-correcting-type-1-error-in-multiple-tests" class="level2">
<h2 class="anchored" data-anchor-id="holms-method-for-correcting-type-1-error-in-multiple-tests">Holm’s method for correcting type 1 error in multiple tests</h2>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

<h4 style="color: blue;" class="anchored">
روش هولم برای تصحیح خطای  نوع اول در آزمون‌های چند‌گانه
</h4>
این روش در حقیقت یک اصلاح هست بر‌روی روش بونفرونی که از مراحل زیر تشکیل شده هست. 
</div>
<p><br></p>
<div dir="rtl" ,="" style="font-size: 18px; font-family: Yas;">
<ul>

<li>فرض کنید که <bdi>m</bdi> آزمون همزمان دارید و مقادیر برآورد شده برای <bdi>p<sub>value</sub></bdi>&nbsp; این آزمون‌ها را از کوچک به بزرگ به شکل زیر مرتب کرده‌اید: <bdi>P<sub>1</sub>, &nbsp; P<sub>2</sub>, &nbsp;, ..., &nbsp; P<sub>m</sub></bdi>&nbsp; و این مقادیر متناظر با فرض‌های اولیه <bdi>H<sub>1</sub>, &nbsp; H<sub>2</sub>, &nbsp;, ..., &nbsp; H<sub>m</sub></bdi>&nbsp;می‌باشد برای به دست آوردن نتیجه هر آزمون البته با تصحیح خطای  نوع اول به شکل زیر عمل می‌کنیم</li>

<li>اگر <bdi>P<sub>1</sub> &lt; <sup>α</sup>⁄<sub>m</sub></bdi> آن‌گاه فرض اولیه <bdi>H<sub>1</sub></bdi>&nbsp; را رد کن و برو گام بعدی، در غیر این صورت  فرض اولیه  <bdi>H<sub>1</sub></bdi>&nbsp; را قبول کن و از ادامه مراحل صرف‌نظر کن</li>

<li>اگر <bdi>P<sub>2</sub> &lt; <sup>α</sup>⁄<sub>(m-1)</sub></bdi> آن‌گاه فرض اولیه <bdi>H<sub>2</sub></bdi>&nbsp; را رد کنید و بروید گام بعدی، در غیر این صورت  فرض اولیه  <bdi>H<sub>2</sub></bdi>&nbsp; را قبول کنید و از ادامه مراحل صرف‌نظر کنید</li>

<li>
این روند ادامه پیدا‌ می‌کند به این‌ شکل که برای هر مقدار <bdi>P<sub>k</sub>, k = 1, 2, ..., m</bdi>&nbsp; اگر <bdi>P<sub>k</sub> &lt; <sup>α</sup>⁄<sub>(m - k + 1)</sub></bdi>&nbsp; آن‌گاه فرض اولیه <bdi>H<sub>k</sub></bdi>&nbsp; را رد کنید و بروید مرحله بعد در غیر این صورت از ادامه مراحل صرف‌نظر کنید. 
</li>
</ul>
این روش اطمینان حاصل می‌کند که مقدار خطای نوع اول چند‌گانه یا در اصطلاح بهتر آن <bdi>FWER (family-wise error rate)</bdi>&nbsp; در سطح خطای نوع اول آزمون باقی بماند. 
<br><br>
مثال:
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.multitest <span class="im">as</span> stest </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>pVal <span class="op">=</span> [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">.01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>]</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> stest.multipletests(pVal, alpha <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"holm"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># python Result</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(array([ True,  True, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False]), array([0.002, 0.019, 0.18 , 1.   , 1.   , 1.   , 1.   , 1.   , 1.   ,
       1.   , 1.   , 1.   , 1.   , 1.   , 0.48 , 0.34 , 1.   , 1.   ,
       1.   , 1.   ]), 0.0025613787765302876, 0.0025)</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R Result</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.001</span>, .<span class="dv">01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>), <span class="at">method =</span> <span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.002 0.019 0.180 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000
[13] 1.000 1.000 0.480 0.340 1.000 1.000 1.000 1.000</code></pre>
</div>
</div>
<p><br><br></p>
</section>
<section id="hochbergs-method-for-correcting-type-1-error-in-multiple-tests" class="level2">
<h2 class="anchored" data-anchor-id="hochbergs-method-for-correcting-type-1-error-in-multiple-tests">Hochberg’s method for correcting type 1 error in multiple tests</h2>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

<h4 style="color: blue;" class="anchored">
روش هاچبرگ برای تصحیح خطای  نوع اول در آزمون‌های چند‌گانه
</h4>

روش هاچبرگ دقیقا مانند روش هولم هست، با این تفاوت که مقایسه‌ها از  بزرگترین مقدار <bdi>p<sub>value</sub></bdi>&nbsp; برآورد شده شروع می‌شود و تا کوچکترین مقدار امتداد پیدا می‌کند یا به عبارتی دیگر عکس مسیری که روش هولم در پیش می‌گرفت، روش هولم مقایسه‌ها را از کوچکترین مقدار <bdi>p<sub>value</sub></bdi>&nbsp; برآورد شده شروع می‌کرد ولی در روش هاچبرگ از بزرگترین مقدار شروع می‌شود و با اولین مقایسه معنادار (رد فرض صفر)، ادامه الگوریتم متوقف می‌شود و تمام مقایسه‌های (آزمون‌های) باقی‌مانده، معنادار گزارش می‌شود. 
<br>
البته یک تفاوت دیگر هم بین این روش و روش هولم وجود دارد و آن تعیین مقدار <bdi>p<sub>value</sub></bdi>&nbsp; در هر مرحله هست، روش‌های ذکر شده همگی تصحیح‌ را را بر روی مقادیر خطای نوع اول انجام می‌دهند ولی همان‌طور که ذکر شده به‌جای مقایسه <bdi>p<sub>value</sub></bdi>&nbsp; هر مرحله با خطای نوع اول آن مرحله، ضریب اِعمال شده در خطای نوع اول هر مرحله را معکوس کرده و در مقدار <bdi>p<sub>value</sub></bdi>&nbsp; همان مرحله ضرب می‌کنند و اسم این مقدار <bdi>p<sub>value</sub></bdi>&nbsp; را مقدار اصلاح شده <bdi>p<sub>value</sub></bdi>&nbsp; می‌نامند ولی همان‌طور که در گفتار بالا گفته شد، <bdi>p<sub>value</sub></bdi>&nbsp; یک مقدار احتمال هست و نمی‌تواند بزرگتر از ۱ باشد لذا مقداری که انتخاب می‌‌شود مقدار کمینه بین ۱ و مقدار حاصل شده هست. 
تفاوت روش هاچبرگ با روش هولم در این‌جاست که روش‌های بونفرونی و هولم مقدار <bdi>p<sub>value</sub></bdi>&nbsp; حاصل شده را با یک مقایسه کرده و مقدار کمینه را در خروجی می‌آورند ولی روش هاچبرگ مقدار حاصل‌شده را با بیشینه مقدار <bdi>p<sub>value</sub></bdi>&nbsp; محاسبه شده با مقادیر <bdi>p<sub>value</sub></bdi>&nbsp; محاسبه شده در همه مقایسه‌های شکل گرفته مقابسه کرده و مقدار مینیم را انتخاب کرده و در خروجی می‌آورد. یعنی در مثال ما چون مقدار بیشینه <bdi>0.9</bdi>&nbsp; می‌باشد لذا آن‌جا که <bdi>p<sub>value</sub></bdi>&nbsp;حاصل شده بیش‌تر از این مقدار باشد، همین مقدار <bdi>0.9</bdi>&nbsp; به عنوان مقدار نهایی برای <bdi>p<sub>value</sub></bdi>&nbsp; آن مرحله در خروجی خواهد آمد. 
<br><br>

مثال: 
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.multitest <span class="im">as</span> stest </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>pVal <span class="op">=</span> [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">.01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>]</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> stest.multipletests(pVal, alpha <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"simes-hochberg"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># python Result</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(array([ True,  True, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False]), array([0.002, 0.019, 0.18 , 0.9  , 0.9  , 0.9  , 0.9  , 0.9  , 0.9  ,
       0.9  , 0.9  , 0.9  , 0.9  , 0.9  , 0.48 , 0.34 , 0.9  , 0.9  ,
       0.9  , 0.9  ]), 0.0025613787765302876, 0.0025)</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R Result</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.001</span>, .<span class="dv">01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>), <span class="at">method =</span> <span class="st">"hochberg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.002 0.019 0.180 0.900 0.900 0.900 0.900 0.900 0.900 0.900 0.900 0.900
[13] 0.900 0.900 0.480 0.340 0.900 0.900 0.900 0.900</code></pre>
</div>
</div>
<p><br><br></p>
</section>
<section id="hommels-method-for-correcting-type-1-error-in-multiple-tests" class="level2">
<h2 class="anchored" data-anchor-id="hommels-method-for-correcting-type-1-error-in-multiple-tests">Hommel’s method for correcting type 1 error in multiple tests</h2>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

<h4 style="color: blue;" class="anchored">
روش هومِل برای تصحیح خطای  نوع اول در آزمون‌های چند‌گانه
</h4>
این روش، نسبتا روش پیچیده‌ای هست البته در مقایسه با روش‌های قبلی. <br>
فرض کنیم؛ 
</div>
<p><span class="math display">\[
\text{H} = \left\{H_{(1)}, H_{(2)}, ..., H_{(m)}\right\},
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
فرض‌های صفر متناظر با آزمون‌های چند‌گانه با مقادیر <bdi>p<sub>value</sub></bdi>&nbsp; برآورد شده به شرح زیر باشد؛ 
<br>

<p style="color: red">
<b>
مقادیر مرتب شده هست.
</b>
</p>
</div>
<p><span class="math display">\[
p_{(1)}, p_{(2)}, ..., p_{(m)}
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
که در این‌جا <bdi>m</bdi> تعداد مقایسه‌های چند‌گانه هست. آن‌گاه برای بررسی معناداری آزمون <bdi>H<sub>i</sub></bdi>&nbsp; به روش زیر عمل می‌کنیم. 
<br>
ابتدا مقدار <bdi>j</bdi> که به فرم زیر هست را محاسبه می‌کنیم
</div>
<p><span class="math display">\[
j = \max\left\{i \in \left\{1, ..., m\right\}:\quad p_{(m -i+k)} &gt; \frac{k\alpha}{i},\quad\text{for}~~k = 1, ..., i\right\}
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
واضح هست که اگر به ازای یک مقدار دلخواه <bdi>i</bdi> هیچ مقداری برای <bdi>j</bdi> حاصل نشود آن‌گاه تمام فرض‌های صفری که در بالا آورده شد رد می‌شود. حالا فرض کنیم که ما برای یک مقدار <bdi>i</bdi> یک مقدار <bdi>j</bdi> به‌دست آورده‌ایم آن‌گاه برای این‌که معناداری <bdi>H<sub>i</sub></bdi>&nbsp; را بررسی کنیم باید این مقایسه را شکل دهیم؛ 
</div>
<p><span class="math display">\[
p_i \geq \frac{\alpha}{j}
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
اگر گزاره شرطی بالا برقرار باشد، آن‌گاه فرض صفر <bdi>H<sub>i</sub></bdi>&nbsp; را می‌پذیریم. 
<br><br>
مثال:
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.multitest <span class="im">as</span> stest </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>pVal <span class="op">=</span> [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">.01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> stest.multipletests(pVal, alpha <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"hommel"</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># python Result</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(array([ True,  True, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False]), array([0.002, 0.019, 0.18 , 0.8  , 0.72 , 0.738, 0.9  , 0.9  , 0.9  ,
       0.9  , 0.9  , 0.9  , 0.9  , 0.9  , 0.42 , 0.32 , 0.738, 0.9  ,
       0.9  , 0.9  ]), 0.0025613787765302876, 0.0025)</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R Result</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.001</span>, .<span class="dv">01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>), <span class="at">method =</span> <span class="st">"hommel"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.002 0.019 0.180 0.800 0.720 0.738 0.900 0.900 0.900 0.900 0.900 0.900
[13] 0.900 0.900 0.420 0.320 0.738 0.900 0.900 0.900</code></pre>
</div>
</div>
<p><br><br></p>
</section>
<section id="benjamini-hochberg-method-bh-for-correcting-type-1-error-in-multiple-tests" class="level2">
<h2 class="anchored" data-anchor-id="benjamini-hochberg-method-bh-for-correcting-type-1-error-in-multiple-tests">Benjamini-Hochberg Method (BH) for correcting type 1 error in multiple tests</h2>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

<h4 style="color: blue;" class="anchored">
روش بنجامینی-هاچبرگ برای تصحیح خطای  نوع اول در آزمون‌های چند‌گانه
</h4>

این روش به نسبت روش قبل ساده‌‌تر هست، ولی تفاوتی که این روش و روش‌هایی که در ادامه می‌آید با روش‌هایی که ذکر شد در این هست که، روش‌های ذکر شده در جهت کنترل خطای نوع اول کل مقایسه یا همان <bdi>(FWER)</bdi>&nbsp; کارکرد خودشان را پیاده‌سازی می‌کردند. ولی این روش و روش‌هایی که در ادامه می‌آید، فارغ از این‌که خطای نوع اول در ابتدا چه مقداری هست در جهت کنترل رد به اشتباه فرض صفر عمل می‌کنند. یا به عبارتی کنترل <bdi>FDR (False Discovery Rate)</bdi>&nbsp;  که نسبت <bdi>FDR</bdi>&nbsp; اشاره دارد به تعداد فرض‌های صفر به اشتباه رد شده بر کل فرض‌های صفر رد شده. 
از این بستر اولین روشی که معرفی می‌شود روش بنجامینی-هاچبرگ هست که مقدار <bdi>p<sub>value</sub></bdi>&nbsp; تصحیح شده با استفاده از این شیوه از طریق زیر حاصل می‌شود.
<br>
در ابتدا مقادیر <bdi>p<sub>value</sub></bdi>&nbsp; برآورد شده را از کوچک به بزرگ مرتب می‌کنیم و در مجموعه زیر قرار می‌دهیم
</div>
<p><span class="math display">\[
\left\{p_{(1)}, p_{(2)}, ..., p_{(m)}\right\}
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
که مقدار <bdi>m</bdi> اشاره به تعداد کل آزمون‌های چند‌گانه دارد. آن‌گاه مقدار <bdi>p<sub>value</sub></bdi>&nbsp; حاصل شده برای عضو <bdi>i<sup>th</sup></bdi>&nbsp; این مجموعه با معادله زیر به دست می‌آید
</div>
<p><span class="math display">\[
p_{(i)}^{(BH)} = \min\left\{\underset{j \geq i}{\min}\left\{\frac{m \times p_{(j)}}{j}\right\}, ~1\right\}
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
<br><br>
مثال:
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.multitest <span class="im">as</span> stest </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>pVal <span class="op">=</span> [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">.01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> stest.multipletests(pVal, alpha <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"fdr_bh"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># python Result</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(array([ True,  True, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False]), array([0.002     , 0.01      , 0.06666667, 0.22222222, 0.22222222,
       0.22222222, 0.3       , 0.32307692, 0.46666667, 0.64705882,
       0.42857143, 0.71111111, 0.81052632, 0.9       , 0.12      ,
       0.1       , 0.22222222, 0.32307692, 0.32307692, 0.5125    ]), 0.0025613787765302876, 0.0025)</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R Result</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.001</span>, .<span class="dv">01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>), <span class="at">method =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.00200000 0.01000000 0.06666667 0.22222222 0.22222222 0.22222222
 [7] 0.30000000 0.32307692 0.46666667 0.64705882 0.42857143 0.71111111
[13] 0.81052632 0.90000000 0.12000000 0.10000000 0.22222222 0.32307692
[19] 0.32307692 0.51250000</code></pre>
</div>
</div>
<p><br><br></p>
</section>
<section id="benjumaini-and-yekutieli-method-by-for-correcting-type-1-error-in-multiple-tests" class="level2">
<h2 class="anchored" data-anchor-id="benjumaini-and-yekutieli-method-by-for-correcting-type-1-error-in-multiple-tests">Benjumaini and Yekutieli Method (BY) for correcting type 1 error in multiple tests</h2>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

<h4 style="color: blue;" class="anchored">
روش بنجامینی-یِکوتیلی برای تصحیح خطای  نوع اول در آزمون‌های چند‌گانه
</h4>

این روش در سال ۲۰۰۱ معرفی شد، مانند روش قبل ولی محافظه‌کارانه‌تر. همچنین به مانند روش قبل در جهت کنترل <bdi>FDR</bdi>&nbsp; می‌باشد. روش محاسبه‌ی <bdi>p<sub>value</sub></bdi>&nbsp; اصلاح شده با این شیوه به فرم زیر هست، در ابتدا اگر فرض کنیم؛
</div>
<p><span class="math display">\[
\text{H} = \left\{H_{(1)}, H_{(2)}, ..., H_{(m)}\right\},
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
فرض‌های صفر متناظر با آزمون‌های چند‌گانه با مقادیر <bdi>p<sub>value</sub></bdi>&nbsp; برآورد شده به شرح زیر باشد؛
<br>

<p style="color: red">
<b>
مقادیر مرتب شده هست.
</b>
</p>
</div>
<p><span class="math display">\[
p_{(1)}, p_{(2)}, ..., p_{(m)}
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
آن‌گاه
</div>
<p><span class="math display">\[
k = \max\left\{i:\quad p_{(i)} \leq \frac{i}{m}\tilde{\alpha}\right\}, \quad \tilde{\alpha} = \frac{\alpha_{(Initial)}}{\sum_{i = 1}^m \frac{1}{i}}
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
 منظور از <bdi>α<sub>Initial</sub></bdi>&nbsp; همان خطای نوع اولی هست که در ابتدا آزمون به آن اشاره می‌شود. و در معادله بالا اگر مقداری برای <bdi>k</bdi> به دست نیاید تمام فرض‌های اولیه پذیرفته می‌شوند. و اگر مقدار برای k به دست بیاید، فرض های 
</div>
<p><span class="math display">\[
\left\{H_1, \dots, H_k\right\}
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
 رد می شود، همان‌طور که مشاهده می کنیم این روش به نسبت دارای محاسبات کمتری و همچنین محافظه‌کارانه‌تر از روش قبلی می‌باشد. 
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.multitest <span class="im">as</span> stest </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>pVal <span class="op">=</span> [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">.01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> stest.multipletests(pVal, alpha <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"fdr_by"</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># python Result</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(array([ True,  True, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False]), array([0.00719548, 0.0359774 , 0.23984931, 0.7994977 , 0.7994977 ,
       0.7994977 , 1.        , 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 0.43172876,
       0.35977397, 0.7994977 , 1.        , 1.        , 1.        ]), 0.0025613787765302876, 0.0025)</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R Result</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.001</span>, .<span class="dv">01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>), <span class="at">method =</span> <span class="st">"BY"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.007195479 0.035977397 0.239849310 0.799497702 0.799497702 0.799497702
 [7] 1.000000000 1.000000000 1.000000000 1.000000000 1.000000000 1.000000000
[13] 1.000000000 1.000000000 0.431728759 0.359773966 0.799497702 1.000000000
[19] 1.000000000 1.000000000</code></pre>
</div>
</div>
<p><br><br></p>
</section>
<section id="false-discovery-rate-fdr-method-for-correcting-type-1-error-in-multiple-tests" class="level2">
<h2 class="anchored" data-anchor-id="false-discovery-rate-fdr-method-for-correcting-type-1-error-in-multiple-tests">False Discovery Rate (FDR) Method for correcting type 1 error in multiple tests</h2>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

<h4 style="color: blue;" class="anchored">
روش <bdi>FDR</bdi>&nbsp; برای تصحیح خطای  نوع اول در آزمون‌های چند‌گانه
</h4>

دو روش آخری که در بالا ذکر شد، یک زیر‌مجموعه از مجموعه‌ روش‌های تصحیح خطا نوع اول با رویکرد اصطلاحا <bdi>FDR</bdi>&nbsp; می‌باشد که در بالا یک اشاره کوتاه به آن شد، اگر بخواهیم به شکل خیلی ساده‌ترین مجموعه روش‌های <bdi>FDR</bdi>&nbsp; را بیان کنیم که البته زیر‌مجموعه‌‌های آن قطعا دارای تفاوت‌هایی هستند، می‌توانیم به این شکل بیان کنیم؛ فرض کنیم مقادیر <bdi>p<sub>value</sub></bdi>&nbsp; به‌دست آمده از آزمون‌ها که از کوچک به بزرگ مرتب شده‌اند به صورت زیر هستند
</div>
<p><span class="math display">\[
P_{value}: ~~\left\{p_{(1)}, p_{(2)}, \dots, p_{(m)}\right\}
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
اگر مانند قبل فرض‌‌های صفر متناظر با مقادیر <bdi>p<sub>value</sub></bdi>&nbsp; ذکر شده در بالا، عبارت باشد از
</div>
<p><span class="math display">\[
\text{H} = \left\{H_{(1)}, H_{(2)}, ..., H_{(m)}\right\},
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
برای برآورد <bdi>p<sub>value</sub></bdi>&nbsp; اصلاح شده به شکل زیر عمل می‌کنیم؛

</div>
<p><span class="math display">\[
p_{(i)}^{(FDR)} = \frac{m}{i} \times p_{(i)} \implies \text{if}~~~ p_{(i)}^{(FDR)} \leq \alpha_{Initial} ~~ \text{Reject}~H_i
\]</span></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
که در این‌جا مقدار <bdi>m</bdi> اشاره به تعداد مقایسه‌های چند‌گانه‌ای هست که می‌خواهیم انجام دهیم. 

<br><br>
مثال: 
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.stats.multitest <span class="im">as</span> stest </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>pVal <span class="op">=</span> [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">.01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>]</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> stest.fdrcorrection(pVal, alpha <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"indep"</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># python Result</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(array([ True,  True, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False]), array([0.002     , 0.01      , 0.06666667, 0.22222222, 0.22222222,
       0.22222222, 0.3       , 0.32307692, 0.46666667, 0.64705882,
       0.42857143, 0.71111111, 0.81052632, 0.9       , 0.12      ,
       0.1       , 0.22222222, 0.32307692, 0.32307692, 0.5125    ]))</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R Result</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.001</span>, .<span class="dv">01</span>, <span class="fl">0.1</span>, <span class="fl">0.08</span>, <span class="fl">0.09</span>, <span class="fl">0.15</span>, <span class="fl">0.21</span>, <span class="fl">0.35</span>, <span class="fl">0.55</span>, <span class="fl">0.3</span>, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fl">0.64</span>, <span class="fl">0.77</span>, <span class="fl">0.9</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.09</span>, <span class="fl">0.19</span>, <span class="fl">0.21</span>, <span class="fl">0.41</span>), <span class="at">method =</span> <span class="st">"fdr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.00200000 0.01000000 0.06666667 0.22222222 0.22222222 0.22222222
 [7] 0.30000000 0.32307692 0.46666667 0.64705882 0.42857143 0.71111111
[13] 0.81052632 0.90000000 0.12000000 0.10000000 0.22222222 0.32307692
[19] 0.32307692 0.51250000</code></pre>
</div>
</div>
<p><br></p>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
متد 
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>statsmodels.stats.multitest.fdrcorrection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div dir="rtl" ,="" style="font-size: 18px;">

 در حقیقت یک ابزار دیگر پایتون برای پیاده‌سازی همان  دو روش قبلی <br> <code>(BH, BY)</code>&nbsp; هست؛ این تابع 
برای آرگومان <bdi>method</bdi> پنج‌تا مقدار می تواند بگیرد که نتایج به دست آمده بر‌اساس هر کدام از مقادیر ذکر شده در راهنمای این تابع، یا نتایج روش <code>BH</code>&nbsp; را دارد یا نتایج روش <code>BY</code>&nbsp;.<br>
همان‌طور که می‌بینیم خروجی روش <code>fdr</code>&nbsp; در <code>R</code>  نتیجه پیاده‌سازی روش <code>BH</code>&nbsp; را دارد، در حقیقت وجود <code>fdr</code>&nbsp; به عنوان یک آرگومان ضرورتی ندارد. البته برای روش‌های مستقر شده بر‌روی مفهوم <code>FDR</code>&nbsp; تیب‌شیرانی نیز روش‌هایی مبتنی بر <code>BH, BY</code>&nbsp; ارائه داده هست که از طریق بسته <code>statsmodels</code>&nbsp; قابل دسترس هستند. برای جزئیات آرگومان‌های تابع ذکر شده در <code>statsmodels</code>&nbsp; می‌توانید به این <a href="https://www.statsmodels.org/dev/generated/statsmodels.stats.multitest.multipletests.html">لینک</a> مراجعه کنید. 

</div>
<p><br><br></p>
</section>
<section id="posthoc-tests-with-adjusted-pvalue" class="level2">
<h2 class="anchored" data-anchor-id="posthoc-tests-with-adjusted-pvalue">PostHoc Tests With Adjusted P<sub>value</sub></h2>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

<h4 style="color: blue;" class="anchored">
پیاده‌سازی آزمون‌های تعقیبی با مقادیر اصلاح شده <bdi>p<sub>value</sub></bdi>&nbsp;
</h4>
در این‌جا با استفاده از یک مجموعه داده ساده یعنی همان داده‌های <code>Iris</code>&nbsp; پیاده‌سازی متدهای ذکر شده را نشان خواهیم داد <br>
برای دسترسی به داده‌‌های <code>iris</code>&nbsp; در پایتون من از بسته <code>reticulate</code>&nbsp; استفاده می‌کنم، البته داده‌های <code>iris</code>&nbsp; در پایتون موجود هست هم در بسته <code>scikit-learn</code>&nbsp;  و هم در کتابخانه <code>statsmodels</code>&nbsp; ولی من برای این گزارش این روش را انتخاب کرده‌ام. 
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## for use iris data in python </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>pathh <span class="ot">&lt;-</span> <span class="fu">Sys.which</span>(<span class="st">"python"</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"//"</span>, <span class="at">x =</span> _,  <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">use_python</span>(pathh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">## use python </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> sfa</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scikit_posthocs <span class="im">as</span> sp</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>dat <span class="op">=</span> r.iris.copy()</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>dat.columns <span class="op">=</span> dat.columns.<span class="bu">str</span>.replace(<span class="st">"."</span>, <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;string&gt;:1: FutureWarning: The default value of regex will change from True to False in a future version. In addition, single character regular expressions will *not* be treated as literal strings when regex=True.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dat.head(<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   SepalLength  SepalWidth  PetalLength  PetalWidth Species
0          5.1         3.5          1.4         0.2  setosa
1          4.9         3.0          1.4         0.2  setosa
2          4.7         3.2          1.3         0.2  setosa
3          4.6         3.1          1.5         0.2  setosa
4          5.0         3.6          1.4         0.2  setosa
5          5.4         3.9          1.7         0.4  setosa
6          4.6         3.4          1.4         0.3  setosa
7          5.0         3.4          1.5         0.2  setosa
8          4.4         2.9          1.4         0.2  setosa
9          4.9         3.1          1.5         0.1  setosa</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">## pairwise comparison use ttest </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>sp.posthoc_ttest(dat, val_col <span class="op">=</span> <span class="st">'SepalWidth'</span>, group_col <span class="op">=</span> <span class="st">'Species'</span>, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>p_adjust <span class="op">=</span> <span class="st">"bonferroni"</span>).<span class="bu">round</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            setosa  versicolor  virginica
setosa         1.0      0.0000     0.0000
versicolor     0.0      1.0000     0.0055
virginica      0.0      0.0055     1.0000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""p_adjust: </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">    bonferroni : one-step correction</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">    sidak : one-step correction</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">    holm-sidak : step down method using Sidak adjustments</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">    holm : step-down method using Bonferroni adjustments</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">    simes-hochberg : step-up method (independent)</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co">    hommel : closed method based on Simes tests (non-negative)</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co">    fdr_bh : Benjamini/Hochberg (non-negative)</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co">    fdr_by : Benjamini/Yekutieli (negative)</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co">    fdr_tsbh : two stage fdr correction (non-negative)</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="co">    fdr_tsbky : two stage fdr correction (non-negative)</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'p_adjust: \n    bonferroni : one-step correction\n\n    sidak : one-step correction\n\n    holm-sidak : step down method using Sidak adjustments\n\n    holm : step-down method using Bonferroni adjustments\n\n    simes-hochberg : step-up method (independent)\n\n    hommel : closed method based on Simes tests (non-negative)\n\n    fdr_bh : Benjamini/Hochberg (non-negative)\n\n    fdr_by : Benjamini/Yekutieli (negative)\n\n    fdr_tsbh : two stage fdr correction (non-negative)\n\n    fdr_tsbky : two stage fdr correction (non-negative)\n'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">## NonParametric pairwise test----</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>sp.posthoc_mannwhitney(a <span class="op">=</span> dat, val_col <span class="op">=</span> <span class="st">'SepalWidth'</span>, group_col <span class="op">=</span> <span class="st">"Species"</span>, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>p_adjust <span class="op">=</span> <span class="st">"fdr_by"</span>).<span class="bu">round</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            setosa  versicolor  virginica
setosa         1.0      0.0000     0.0000
versicolor     0.0      1.0000     0.0084
virginica      0.0      0.0084     1.0000</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R: pairwise Ttest</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(<span class="at">x =</span> iris<span class="sc">$</span>Sepal.Width, <span class="at">g =</span> iris<span class="sc">$</span>Species, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>, <span class="at">pool.sd =</span> F) <span class="sc">|&gt;</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>_<span class="sc">$</span>p.value <span class="sc">|&gt;</span> </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           setosa versicolor
versicolor      0         NA
virginica       0     0.0055</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## R: pairwise wilcoxon test</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(<span class="at">x =</span> iris<span class="sc">$</span>Sepal.Width, <span class="at">g =</span> iris<span class="sc">$</span>Species, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="at">p.adjust.method =</span> <span class="st">"BY"</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>_<span class="sc">$</span>p.value <span class="sc">|&gt;</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           setosa versicolor
versicolor      0         NA
virginica       0     0.0084</code></pre>
</div>
</div>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">
واضح هست که نتایج گزارش شده در هر دو پلتفرم <code>(<b><mark><span style="font-family: courier new;">R, python</span></mark>)</b></code>&nbsp;  یکسان هست. 
</div>
<hr>
<hr>
<p><br><br></p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div dir="rtl" ,="" style="color: black; font-size: 18px; font-family: Yas;">

<h4 style="color: blue;" class="anchored">
منابع
</h4></div>
<ol type="1">
<li>Hsu JC. Multiple comparisons: theory and methods. London: Chapman &amp; Hall: CRC Press, 1996. [<a href="https://scholar.google.com/scholar_lookup?journal=Stat+Methods+Med+Res&amp;title=A+review+of+modern+multiple+hypothesis+testing,+with+particular+attention+to+the+false+discovery+proportion.&amp;author=A.+Farcomeni&amp;volume=17&amp;publication_year=2008&amp;pages=347-88&amp;pmid=17698936&amp;doi=10.1177/0962280206079046&amp;">Google Scholar</a>]</li>
<li>Bender R, Lange S. Adjusting for multiple testing—when and how? J Clin Epidemiol 2001;54:343-9. 10.1016/S0895-4356(00)00314-0 [<a href="https://scholar.google.com/scholar_lookup?journal=J+Clin+Epidemiol&amp;title=Adjusting+for+multiple+testing%E2%80%94when+and+how?&amp;author=R+Bender&amp;author=S+Lange&amp;volume=54&amp;publication_year=2001&amp;pages=343-9&amp;pmid=11297884&amp;doi=10.1016/S0895-4356(00)00314-0&amp;">Google Scholar</a>]</li>
<li>Thiese MS, Ronna B, Ott U. P value interpretations and considerations. J Thorac Dis 2016;8:E928-E931. 10.21037/jtd.2016.08.16 [<a href="https://scholar.google.com/scholar_lookup?journal=J+Thorac+Dis&amp;title=P+value+interpretations+and+considerations.&amp;author=MS+Thiese&amp;author=B+Ronna&amp;author=U+Ott&amp;volume=8&amp;publication_year=2016&amp;pages=E928-E931&amp;pmid=27747028&amp;doi=10.21037/jtd.2016.08.16&amp;">Google Scholar</a>]</li>
<li>Farcomeni A. A review of modern multiple hypothesis testing, with particular attention to the false discovery proportion. Stat Methods Med Res 2008;17:347-88. 10.1177/0962280206079046 [<a href="https://scholar.google.com/scholar_lookup?journal=Stat+Methods+Med+Res&amp;title=A+review+of+modern+multiple+hypothesis+testing,+with+particular+attention+to+the+false+discovery+proportion.&amp;author=A.+Farcomeni&amp;volume=17&amp;publication_year=2008&amp;pages=347-88&amp;pmid=17698936&amp;doi=10.1177/0962280206079046&amp;">Google Scholar</a>]</li>
<li>Bland JM, Altman DG. Multiple significance tests: the Bonferroni method. BMJ 1995;310:170. 10.1136/bmj.310.6973.170 [<a href="https://scholar.google.com/scholar_lookup?journal=BMJ&amp;title=Multiple+significance+tests:+the+Bonferroni+method.&amp;author=JM+Bland&amp;author=DG+Altman&amp;volume=310&amp;publication_year=1995&amp;pages=170&amp;pmid=7833759&amp;doi=10.1136/bmj.310.6973.170&amp;">Google Scholar</a>]</li>
<li>Holm M. A simple sequentially rejective multiple test procedure. Scand J Statist 1979;6:65-70. [<a href="https://scholar.google.com/scholar_lookup?journal=Scand+J+Statist&amp;title=A+simple+sequentially+rejective+multiple+test+procedure.&amp;author=M.+Holm&amp;volume=6&amp;publication_year=1979&amp;pages=65-70&amp;">Google Scholar</a>]</li>
<li>Hochberg Y. A sharper Bonferroni procedure for multiple tests of significance. Biometrika 1988;75:800-2. 10.1093/biomet/75.4.800 [<a href="https://scholar.google.com/scholar_lookup?journal=Biometrika&amp;title=A+sharper+Bonferroni+procedure+for+multiple+tests+of+significance.&amp;author=Y.+Hochberg&amp;volume=75&amp;publication_year=1988&amp;pages=800-2&amp;doi=10.1093/biomet/75.4.800&amp;">Google Scholar</a>]</li>
<li>Simes RJ. An improved Bonferroni procedure for multiple tests of significance. Biometrika 1986;73:751-4. 10.1093/biomet/73.3.751 [<a href="https://scholar.google.com/scholar_lookup?journal=Biometrika&amp;title=An+improved+Bonferroni+procedure+for+multiple+tests+of+significance.&amp;author=RJ+Simes&amp;volume=73&amp;publication_year=1986&amp;pages=751-4&amp;doi=10.1093/biomet/73.3.751&amp;">Google Scholar</a>]</li>
<li>Hommel G. A stagewise rejective multiple test procedure based on a modified Bonferroni test. Biometrika 1988;75:383-6. 10.1093/biomet/75.2.383 [<a href="https://scholar.google.com/scholar_lookup?journal=Biometrika&amp;title=A+stagewise+rejective+multiple+test+procedure+based+on+a+modified+Bonferroni+test.&amp;author=G.+Hommel&amp;volume=75&amp;publication_year=1988&amp;pages=383-6&amp;doi=10.1093/biomet/75.2.383&amp;">Google Scholar</a>]</li>
<li>Benjamini Y, Hochberg Y. Controlling the false discovery rate: a practical and powerful approach to multiple testing. J R Stat Soc Series B Stat Methodol 1995;57:289-300. [<a href="https://scholar.google.com/scholar_lookup?journal=J+R+Stat+Soc+Series+B+Stat+Methodol&amp;title=Controlling+the+false+discovery+rate:+a+practical+and+powerful+approach+to+multiple+testing.&amp;author=Y+Benjamini&amp;author=Y+Hochberg&amp;volume=57&amp;publication_year=1995&amp;pages=289-300&amp;">Google Scholar</a>]</li>
<li>Benjamini Y, Yekutieli D. The control of the false discovery rate in multiple testing under dependency. Ann Stat 2001;29:1165-88. [<a href="https://scholar.google.com/scholar_lookup?journal=Ann+Stat&amp;title=The+control+of+the+false+discovery+rate+in+multiple+testing+under+dependency.&amp;author=Y+Benjamini&amp;author=D+Yekutieli&amp;volume=29&amp;publication_year=2001&amp;pages=1165-88&amp;">Google Scholar</a>]</li>
</ol>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="stats9/BlueSkyProject" issue-term="og:title" theme="github-dark-orange" crossorigin="anonymous" async="">
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./BlueSky.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">BlueSky</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Anova-SS.html" class="pagination-link">
        <span class="nav-page-text">Anova-SS</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/stats9">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/habib-ezzat-abadi-pour-23300abb/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:habibezati88@gmail.com">
      <i class="bi bi-envelope-at" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">Copyright 2023, Habib Ezatabadi</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>